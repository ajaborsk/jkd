<!doctype html>
<html lang="fr">
<head>
  <meta charset="utf-8">
  <title>Titre de la page</title>
  <link rel="stylesheet" href="/static/css/jkd.css">
  <script src="/static/scripts/jquery-3.3.1.min.js"></script>
</head>
<body>
  <p>{{name}}</p>
  <!-- Le reste du contenu -->
  <p id="test1">Blabla</p>
  <span id="push">Press me</span>
  <div id="status_bar"><span id="conn_status">Connecting...</span></div>
<script>

$(document).ready(function()
 {
  // jQuery methods go here...
  // First of all: launch websocket connection
  websocket = new WebSocket("ws://localhost:8080/ws");

  $("#test1").text("Hello world!");

  $("#push").click(function(evt){websocket.send(JSON.stringify({"data":"lokfid"}))});

  websocket.onopen = function(evt)
   {
    $("#conn_status").text("Connected");
     websocket.send(JSON.stringify({"data":"Plikdf 1"}));
   };

  // Message handling
  websocket.onmessage = function(evt)
   {
    msg = JSON.parse(evt.data);
    $("#test1").text("Response : " + msg.reply);
   };

  websocket.onclose = function(evt)
   {
    $("#conn_status").text("Unconnected");
   };

//TODO:
// Error handling
//  websocket.onerror = function(evt) { onError(evt) };
});

</script>
</body>
</html>
